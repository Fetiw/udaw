"use strict";

var SIZE_ROW = 20;
var SIZE_COL = 20;

function randomInteger(min, max) {
  var rand = min - 0.5 + Math.random() * (max - min + 1);
  rand = Math.round(rand);
  return rand;
}

function Shake(matrix) {
  var currentCourse = { row: 1, col: 0 };
  var body = [{
    row: randomInteger(0, SIZE_ROW),
    col: randomInteger(0, SIZE_COL)
  }];

  matrix.fireCells(body);

  function move() {
    var head = body[0];

    console.log(head);
    var nextHead = getNextCoordinates(head, currentCourse);
    console.log(head);

    body.unshift(nextHead);
    matrix.fireCells([nextHead]);

    var tail = body.pop();
    matrix.cleanCells([tail]);
  }

  function getNextCoordinates(coordinates, currentCourse) {
    coordinates.test = 1;
    var newCoordinates = {
      row: coordinates.row + currentCourse.row,
      col: coordinates.col + currentCourse.col
    };

    if (newCoordinates.row < 0) {
      newCoordinates.row = SIZE_ROW - 1;
    }

    if (newCoordinates.row === SIZE_ROW) {
      newCoordinates.row = 0;
    }

    if (newCoordinates.col < 0) {
      newCoordinates.col = SIZE_COL - 1;
    }

    if (newCoordinates.col === SIZE_COL) {
      newCoordinates.col = 0;
    }

    return newCoordinates;
  }

  function setCourse(course) {
    var COURSE = {
      "ArrowUp": { row: -1, col: 0 },
      "ArrowDown": { row: 1, col: 0 },
      "ArrowRight": { row: 0, col: 1 },
      "ArrowLeft": { row: 0, col: -1 }
    };

    currentCourse = COURSE[course];
  }

  return {
    move: move,
    setCourse: setCourse
  };
}

function MATRIX($container, i, j) {
  $container.css({
    width: 40 * i + 50,
    height: 40 * j + 50
  });

  for (var row = 0; row < i; row++) {
    for (var col = 0; col < j; col++) {
      $container.append("<div class='block' data-row='" + row + "' data-col='" + col + "'/>");
    }
  }

  function fireCells(coordinates) {
    for (var _i = 0; _i < coordinates.length; _i++) {
      $(".block[data-row=" + coordinates[_i].row + "][data-col=" + coordinates[_i].col + "]").addClass('blue');
    }
  }

  function cleanCells(coordinates) {
    for (var _i2 = 0; _i2 < coordinates.length; _i2++) {
      $(".block[data-row=" + coordinates[_i2].row + "][data-col=" + coordinates[_i2].col + "]").removeClass('blue');
    }
  }

  return {
    cleanCells: cleanCells,
    fireCells: fireCells
  };
}

function start() {
  var matrix = MATRIX($('#matrix'), SIZE_COL, SIZE_ROW);
  var snake = Shake(matrix);

  $(window).keydown(function (e) {
    snake.setCourse(e.key);
  });

  setInterval(function () {
    snake.move();
  }, 300);
}

start();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbS5qcyJdLCJuYW1lcyI6WyJTSVpFX1JPVyIsIlNJWkVfQ09MIiwicmFuZG9tSW50ZWdlciIsIm1pbiIsIm1heCIsInJhbmQiLCJNYXRoIiwicmFuZG9tIiwicm91bmQiLCJTaGFrZSIsIm1hdHJpeCIsImN1cnJlbnRDb3Vyc2UiLCJyb3ciLCJjb2wiLCJib2R5IiwiZmlyZUNlbGxzIiwibW92ZSIsImhlYWQiLCJjb25zb2xlIiwibG9nIiwibmV4dEhlYWQiLCJnZXROZXh0Q29vcmRpbmF0ZXMiLCJ1bnNoaWZ0IiwidGFpbCIsInBvcCIsImNsZWFuQ2VsbHMiLCJjb29yZGluYXRlcyIsInRlc3QiLCJuZXdDb29yZGluYXRlcyIsInNldENvdXJzZSIsImNvdXJzZSIsIkNPVVJTRSIsIk1BVFJJWCIsIiRjb250YWluZXIiLCJpIiwiaiIsImNzcyIsIndpZHRoIiwiaGVpZ2h0IiwiYXBwZW5kIiwibGVuZ3RoIiwiJCIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJzdGFydCIsInNuYWtlIiwid2luZG93Iiwia2V5ZG93biIsImUiLCJrZXkiLCJzZXRJbnRlcnZhbCJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNQSxXQUFXLEVBQWpCO0FBQ0EsSUFBTUMsV0FBVyxFQUFqQjs7QUFFQSxTQUFTQyxhQUFULENBQXVCQyxHQUF2QixFQUE0QkMsR0FBNUIsRUFBaUM7QUFDL0IsTUFBSUMsT0FBT0YsTUFBTSxHQUFOLEdBQVlHLEtBQUtDLE1BQUwsTUFBaUJILE1BQU1ELEdBQU4sR0FBWSxDQUE3QixDQUF2QjtBQUNBRSxTQUFPQyxLQUFLRSxLQUFMLENBQVdILElBQVgsQ0FBUDtBQUNBLFNBQU9BLElBQVA7QUFDRDs7QUFFRCxTQUFTSSxLQUFULENBQWVDLE1BQWYsRUFBdUI7QUFDckIsTUFBSUMsZ0JBQWdCLEVBQUVDLEtBQUssQ0FBUCxFQUFVQyxLQUFLLENBQWYsRUFBcEI7QUFDQSxNQUFJQyxPQUFPLENBQUM7QUFDVkYsU0FBS1YsY0FBYyxDQUFkLEVB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QyxtQkFBcURjLFlBQVlRLEVBQVosRUFBZXJCLEdBQXBFLFFBQ0c2QixRQURILENBQ1ksTUFEWjtBQUVEO0FBQ0Y7O0FBRUQsV0FBU2pCLFVBQVQsQ0FBb0JDLFdBQXBCLEVBQWlDO0FBQy9CLFNBQUssSUFBSVEsTUFBSSxDQUFiLEVBQWdCQSxNQUFJUixZQUFZYyxNQUFoQyxFQUF3Q04sS0FBeEMsRUFBOEM7QUFDNUNPLDZCQUFxQmYsWUFBWVEsR0FBWixFQUFldEIsR0FBcEMsbUJBQXFEYyxZQUFZUSxHQUFaLEVBQWVyQixHQUFwRSxRQUNHOEIsV0FESCxDQUNlLE1BRGY7QUFFRDtBQUNGOztBQUVELFNBQU87QUFDTGxCLGdCQUFZQSxVQURQO0FBRUxWLGVBQVdBO0FBRk4sR0FBUDtBQUlEOztBQUVELFNBQVM2QixLQUFULEdBQWlCO0FBQ2YsTUFBSWxDLFNBQVNzQixPQUFPUyxFQUFFLFNBQUYsQ0FBUCxFQUFxQnhDLFFBQXJCLEVBQStCRCxRQUEvQixDQUFiO0FBQ0EsTUFBSTZDLFFBQVFwQyxNQUFNQyxNQUFOLENBQVo7O0FBR0ErQixJQUFFSyxNQUFGLEVBQVVDLE9BQVYsQ0FBa0IsVUFBU0MsQ0FBVCxFQUFZO0FBQzVCSCxVQUFNaEIsU0FBTixDQUFnQm1CLEVBQUVDLEdBQWxCO0FBQ0QsR0FGRDs7QUFJQUMsY0FBWSxZQUFXO0FBQ3JCTCxVQUFNN0IsSUFBTjtBQUNELEdBRkQsRUFFRyxHQUZIO0FBR0Q7O0FBRUQ0QiIsImZpbGUiOiJjdXN0b20uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTSVpFX1JPVyA9IDIwO1xuY29uc3QgU0laRV9DT0wgPSAyMDtcblxuZnVuY3Rpb24gcmFuZG9tSW50ZWdlcihtaW4sIG1heCkge1xuICBsZXQgcmFuZCA9IG1pbiAtIDAuNSArIE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSk7XG4gIHJhbmQgPSBNYXRoLnJvdW5kKHJhbmQpO1xuICByZXR1cm4gcmFuZDtcbn1cblxuZnVuY3Rpb24gU2hha2UobWF0cml4KSB7XG4gIGxldCBjdXJyZW50Q291cnNlID0geyByb3c6IDEsIGNvbDogMCB9O1xuICBsZXQgYm9keSA9IFt7XG4gICAgcm93OiByYW5kb21JbnRlZ2VyKDAsIFNJWkVfUk9XKSxcbiAgICBjb2w6IHJhbmRvbUludGVnZXIoMCwgU0laRV9DT0wpXG4gIH1dO1xuXG4gIG1hdHJpeC5maXJlQ2VsbHMoYm9keSk7XG5cbiAgZnVuY3Rpb24gbW92ZSgpIHtcbiAgICBsZXQgaGVhZCA9IGJvZHlbMF07XG5cbiAgICBjb25zb2xlLmxvZyhoZWFkKTtcbiAgICBsZXQgbmV4dEhlYWQgPSBnZXROZXh0Q29vcmRpbmF0ZXMoaGVhZCwgY3VycmVudENvdXJzZSk7XG4gICAgY29uc29sZS5sb2coaGVhZCk7XG5cbiAgICBib2R5LnVuc2hpZnQobmV4dEhlYWQpO1xuICAgIG1hdHJpeC5maXJlQ2VsbHMoW25leHRIZWFkXSk7XG5cbiAgICBsZXQgdGFpbCA9IGJvZHkucG9wKCk7XG4gICAgbWF0cml4LmNsZWFuQ2VsbHMoW3RhaWxdKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldE5leHRDb29yZGluYXRlcyhjb29yZGluYXRlcywgY3VycmVudENvdXJzZSkge1xuICAgIGNvb3JkaW5hdGVzLnRlc3QgPSAxO1xuICAgIGxldCBuZXdDb29yZGluYXRlcyA9IHtcbiAgICAgIHJvdzogY29vcmRpbmF0ZXMucm93ICsgY3VycmVudENvdXJzZS5yb3csXG4gICAgICBjb2w6IGNvb3JkaW5hdGVzLmNvbCArIGN1cnJlbnRDb3Vyc2UuY29sXG4gICAgfTtcblxuXG4gICAgaWYoIG5ld0Nvb3JkaW5hdGVzLnJvdyA8IDAgKSB7XG4gICAgICBuZXdDb29yZGluYXRlcy5yb3cgPSBTSVpFX1JPVyAtIDE7XG4gICAgfVxuXG4gICAgaWYoIG5ld0Nvb3JkaW5hdGVzLnJvdyA9PT0gU0laRV9ST1cgKSB7XG4gICAgICBuZXdDb29yZGluYXRlcy5yb3cgPSAwO1xuICAgIH1cblxuICAgIGlmKCBuZXdDb29yZGluYXRlcy5jb2wgPCAwICkge1xuICAgICAgbmV3Q29vcmRpbmF0ZXMuY29sID0gU0laRV9DT0wgLSAxO1xuICAgIH1cblxuICAgIGlmKCBuZXdDb29yZGluYXRlcy5jb2wgPT09IFNJWkVfQ09MICkge1xuICAgICAgbmV3Q29vcmRpbmF0ZXMuY29sID0gMDtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3Q29vcmRpbmF0ZXM7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRDb3Vyc2UoY291cnNlKSB7XG4gICAgY29uc3QgQ09VUlNFID0ge1xuICAgICAgXCJBcnJvd1VwXCI6IHsgcm93OiAtMSwgY29sOiAwIH0sXG4gICAgICBcIkFycm93RG93blwiOiB7IHJvdzogMSwgY29sOiAwIH0sXG4gICAgICBcIkFycm93UmlnaHRcIjogeyByb3c6IDAsIGNvbDogMSB9LFxuICAgICAgXCJBcnJvd0xlZnRcIjogeyByb3c6IDAsIGNvbDogLTEgfSxcbiAgICB9O1xuXG4gICAgY3VycmVudENvdXJzZSA9IENPVVJTRVtjb3Vyc2VdO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBtb3ZlOiBtb3ZlLFxuICAgIHNldENvdXJzZTogc2V0Q291cnNlXG4gIH1cbn1cblxuZnVuY3Rpb24gTUFUUklYKCRjb250YWluZXIsIGksIGopIHtcbiAgJGNvbnRhaW5lci5jc3Moe1xuICAgIHdpZHRoOiA0MCAqIGkgKyA1MCxcbiAgICBoZWlnaHQ6IDQwICogaiArIDUwLFxuICB9KTtcblxuICBmb3IoIGxldCByb3cgPSAwOyByb3cgPCBpOyByb3crKyApIHtcbiAgICBmb3IoIGxldCBjb2wgPSAwOyBjb2wgPCBqOyBjb2wrKyApIHtcbiAgICAgICRjb250YWluZXIuYXBwZW5kKGA8ZGl2IGNsYXNzPSdibG9jaycgZGF0YS1yb3c9JyR7cm93fScgZGF0YS1jb2w9JyR7Y29sfScvPmApO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGZpcmVDZWxscyhjb29yZGluYXRlcykge1xuICAgIGZvciggbGV0IGkgPSAwOyBpIDwgY29vcmRpbmF0ZXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAkKGAuYmxvY2tbZGF0YS1yb3c9JHtjb29yZGluYXRlc1tpXS5yb3d9XVtkYXRhLWNvbD0ke2Nvb3JkaW5hdGVzW2ldLmNvbH1dYClcbiAgICAgICAgLmFkZENsYXNzKCdibHVlJyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY2xlYW5DZWxscyhjb29yZGluYXRlcykge1xuICAgIGZvciggbGV0IGkgPSAwOyBpIDwgY29vcmRpbmF0ZXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAkKGAuYmxvY2tbZGF0YS1yb3c9JHtjb29yZGluYXRlc1tpXS5yb3d9XVtkYXRhLWNvbD0ke2Nvb3JkaW5hdGVzW2ldLmNvbH1dYClcbiAgICAgICAgLnJlbW92ZUNsYXNzKCdibHVlJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBjbGVhbkNlbGxzOiBjbGVhbkNlbGxzLFxuICAgIGZpcmVDZWxsczogZmlyZUNlbGxzXG4gIH1cbn1cblxuZnVuY3Rpb24gc3RhcnQoKSB7XG4gIGxldCBtYXRyaXggPSBNQVRSSVgoJCgnI21hdHJpeCcpLCBTSVpFX0NPTCwgU0laRV9ST1cpO1xuICBsZXQgc25ha2UgPSBTaGFrZShtYXRyaXgpO1xuXG5cbiAgJCh3aW5kb3cpLmtleWRvd24oZnVuY3Rpb24oZSkge1xuICAgIHNuYWtlLnNldENvdXJzZShlLmtleSk7XG4gIH0pO1xuXG4gIHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgIHNuYWtlLm1vdmUoKTtcbiAgfSwgMzAwKTtcbn1cblxuc3RhcnQoKTtcblxuXG5cbiJdfQ==
